# TheSelective Training Configuration
# Unified dual-head model with bidirectional cross-attention

data:
  name: pl
  path: ./data/crossdocked_v1.1_rmsd1.0_pocket10_processed_final.lmdb
  split: ./data/crossdocked_pocket10_pose_split.pt
  transform:
    ligand_atom_mode: add_aromatic
    random_rot: False

model:
  # Diffusion settings
  model_mean_type: C0
  beta_schedule: sigmoid
  beta_start: 1.e-7
  beta_end: 2.e-3
  v_beta_schedule: cosine
  v_beta_s: 0.01
  num_diffusion_timesteps: 1000
  loss_v_weight: 100.
  loss_exp_weight: 1.
  sample_time_method: symmetric
  affinity_with_diffusion: False
  use_classifier_guide: True

  # Time embedding
  time_emb_dim: 0
  time_emb_mode: simple
  center_pos_mode: protein

  # Model architecture
  node_indicator: True
  model_type: uni_o2
  num_blocks: 1
  num_layers: 9
  hidden_dim: 128
  n_heads: 16
  edge_feat_dim: 4
  num_r_gaussian: 20
  knn: 32
  num_node_types: 8
  act_fn: relu
  norm: True
  cutoff_mode: knn
  ew_net_type: global
  num_x2h: 1
  num_h2x: 1
  r_max: 10.
  x2h_out_fc: False
  sync_twoup: False

  # Dual Head Configuration
  use_dual_head_sam_pl: True
  head2_mode: bidirectional_query_atom

train:
  seed: 2021
  batch_size: 2
  num_workers: 1
  n_acc_batch: 2
  max_iters: 10000000
  val_freq: 1000
  pos_noise_std: 0.1
  max_grad_norm: 8.0
  bond_loss_weight: 1.0
  optimizer:
    type: adam
    lr: 1.e-3
    weight_decay: 0
    beta1: 0.95
    beta2: 0.999
  scheduler:
    type: plateau
    factor: 0.95
    patience: 15
    min_lr: 1.e-5
